# -*- coding: utf-8 -*-

import gmpy2
import binascii

"""
OK I'm so confident with this RSA stuff I'm using it to send messages to all my friends.

Can you figure out this message I've sent to all my friends?
"""

e1 = 3
n1 = 1001191535967882284769094654562963158339094991366537360172618359025855097846977704928598237040115495676223744383629803332394884046043603063054821999994629411352862317941517957323746992871914047324555019615398720677218748535278252779545622933662625193622517947605928420931496443792865516592262228294965047903627
c1 = 613757444204638278262310351562876531607487738717774407185252131147104492450160428757483976067628603514761619532764928239807564974590961450735755461481051283186240767490110455431475543041011912015289781128865893349142785039408178696523937605624371679605130950843591197358935516266254687080122972023592091964871

e2 = 3
n2 = 405864605704280029572517043538873770190562953923346989456102827133294619540434679181357855400199671537151039095796094162418263148474324455458511633891792967156338297585653540910958574924436510557629146762715107527852413979916669819333765187674010542434580990241759130158992365304284892615408513239024879592309
c2 = 22657108022478695797486965023447848250682406595690518779077232421899889165762724488153241456845951937121308084431913683848889272505486222688188138471999687468256556616878979818168438370975399291696045396880071048188564812795530986969364538462949239012254381251606438993964309325106863727351705595563360310007

e3 = 3
n3 = 1204664380009414697639782865058772653140636684336678901863196025928054706723976869222235722439176825580211657044153004521482757717615318907205106770256270292154250168657084197056536811063984234635803887040926920542363612936352393496049379544437329226857538524494283148837536712608224655107228808472106636903723
c3 = 311096000497881387953904724284440481805457233048982756757007020410000443330941053703716829538086459727079448020579354693958905904778381820371160626001594619419169121166486655254993091181369105737797409452734836563374374511516011594235202125201067840325349354834604004321427713901643355933701994777952169157646

# Small Exponent 3, Same Message Encrypted with 3 different Keys ---> The Chinese Remainder Theorem
# Maths on website http://www.di-mgt.com.au/crt.html

N = n1*n2*n3

N1 = N//n1
N2 = N//n2
N3 = N//n3

d1 = gmpy2.invert(N1,n1)
d2 = gmpy2.invert(N2,n2)
d3 = gmpy2.invert(N3,n3)

m = int(((c1*N1*d1) + (c2*N2*d2) + (c3*N3*d3))%N)

# Get the cubic root of m 
cubic_root = int(gmpy2.iroot(m, 3)[0])

print (binascii.unhexlify(hex(int(cubic_root))[2:]).decode('utf-8'))
